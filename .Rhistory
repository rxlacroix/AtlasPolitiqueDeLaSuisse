data <- read.csv("votations.csv", header = TRUE, sep = ";", encoding = "latin1")
rownames(data) <- make.names(data$Commune, unique=TRUE)
colnames(data) <- stri_sub(colnames(data),2) # enleve les X des noms de colonne
library(FactoMineR)
library(factoextra)
library(stringi)
library(psych)
library(REdaS)
library(knitr)
library(reshape2)
colnames(data) <- stri_sub(colnames(data),2) # enleve les X des noms de colonne
data <- data[, -1]
data <- data[,order(as.Date(substr(colnames(data),1, 10),
format="%d.%m.%Y"))] # trie les colonnes par date
head(data[,1:5])
data_old <- data[,4:187]
plot(data$`03.03.2002.AdhÃ©sion.de.la.Suisse.Ã .l.ONU`,
data$`12.06.1994.Naturalisation.facilitÃ©e.pour.les.jeunes.Ã©trangers`,
xlab = "AdhÃ©sion Ã  l'ONU (2002)",
ylab = "Naturalisation facilitÃ©e pour les jeunes Ã©trangers (1994)",
xlim=c(0,100), ylim=c(0,100))
plot(data$`03.03.2002.Adhésion.de.la.Suisse.à.l.ONU`,
data$`12.06.1994.Naturalisation.facilitée.pour.les.jeunes.étrangers`,
xlab = "AdhÃ©sion Ã  l'ONU (2002)",
ylab = "Naturalisation facilitÃ©e pour les jeunes Ã©trangers (1994)",
xlim=c(0,100), ylim=c(0,100))
c <-cor(data_old)
kmo <- KMO(data_old)
kmo$MSA
bart_spher(data_old)
acp <- principal(data_old, nfactors = 3, rotate = "varimax")
summary(acp)
p <- print(acp)
round(p$Vaccounted,2)
plot(100*acp$values/sum(acp$values),
xlim = c(1,8), ylim = c(0,30),
xlab = "Composante", ylab = "% de variance expliquÃ©e",
type = "b", las=1)
kable(acp$loadings[,c(3,1,2)], digits=4)
p <- print(ICLUST.sort(acp$loadings))
resultRC3 <-melt(data.frame(p$content[129:149],p$RC3[129:149]))
resultRC3 <- resultRC3[,-2]
colnames(resultRC3) <- c("Votation","loading")
kable(resultRC3)
resultRC1 <-melt(data.frame(p$content[71:95],p$RC1[71:95]))
resultRC1 <- resultRC1[,-2]
colnames(resultRC1) <- c("Votation","loading")
kable(resultRC1)
resultRC2 <-melt(data.frame(p$content[1:20],p$RC2[1:20]))
resultRC2 <- resultRC2[,-2]
colnames(resultRC2) <- c("Votation","loading")
kable(resultRC2)
scores <- as.data.frame(acp$scores)
head(scores)
par(pty="s")
plot(-scores$RC3, scores$RC1, xlab = "", ylab = "", xaxt='n', yaxt="n", pch=10, cex=.3)
mtext('Droite', side=4, line=2, las=1)
par(pty="s")
plot(-scores$RC3, scores$RC1, xlab = "", ylab = "", xaxt='n', yaxt="n", pch=10, cex=.3)
mtext('Droite', side=4, line=2, las=1)
mtext('Gauche', side=2, line=2, las=1)
mtext("LibÃ©ral", side =3, line=1)
mtext("Conservateur", side =1, line=1)
communes <- read.csv("communes.csv")
communes$Habitants <- as.numeric(gsub('![[:alnum:]]*[[:space:]]|[[:punct:]]', '', communes$Habitants))
communes$Commune  <- gsub('-', ' ', communes$Commune)
scores$Commune <- row.names(scores)
scores$Commune <- stri_sub(scores$Commune,3)
scores$Commune <- gsub('\\.\\.', ' (', scores$Commune)
scores$Commune <- gsub('H\\.', 'H)', scores$Commune)
scores$Commune <- gsub('G\\.', 'G)', scores$Commune)
scores$Commune <- gsub('Z\\.', 'Z)', scores$Commune)
scores$Commune <- gsub('E\\.', 'E)', scores$Commune)
scores$Commune <- gsub('L\\.', 'L)', scores$Commune)
scores$Commune <- gsub('U\\.', 'U)', scores$Commune)
scores$Commune <- gsub('R\\.', 'R)', scores$Commune)
scores$Commune <- gsub('O\\.', 'O)', scores$Commune)
scores$Commune <- gsub('W\\.', 'W)', scores$Commune)
scores$Commune <- gsub('D\\.', 'D)', scores$Commune)
scores$Commune <- gsub('S\\.', 'S)', scores$Commune)
scores$Commune <- gsub('\\.', ' ', scores$Commune)
scores$Commune <- gsub('\\(Urne commune', '', scores$Commune)
scores$Commune <- gsub('St \\(', 'St\\. ', scores$Commune)
scores$Commune <- gsub('Biel Bienne', 'Biel/Bienne', scores$Commune)
scores <- merge(scores, communes, by= "Commune")
scores <- scores[,1:6]
scores$langue <- ""
scores$langue <- ""
scores$langue[scores$Code.commune <1720] <- "ALL"
scores$langue[scores$Code.commune <5400 & scores$Code.commune > 5000] <- "ITA" # TI
scores$langue[scores$Code.commune >5400 & scores$Code.commune < 5940] <- "FRA" # VD
scores$langue[scores$Code.commune >6400] <- "FRA" # JU GE NE
scores$langue[scores$Code.commune >1000 & scores$Code.commune < 1720] <- "ALL"
scores$langue[scores$Code.commune >2400 & scores$Code.commune < 4960] <- "ALL"
scores$langue[scores$Code.commune >2000 & scores$Code.commune < 2340] <- "FRA"
scores$langue[scores$Code.commune >6000 & scores$Code.commune < 6012] <- "ALL"
scores$langue[scores$Code.commune >6020 & scores$Code.commune < 6040] <- "FRA"
scores$langue[scores$Code.commune >6040 & scores$Code.commune < 6080] <- "ALL"
scores$langue[scores$Code.commune >6080 & scores$Code.commune < 6100] <- "FRA"
scores$langue[scores$Code.commune >6100 & scores$Code.commune < 6120] <- "ALL"
scores$langue[scores$Code.commune >6120 & scores$Code.commune < 6160] <- "FRA"
scores$langue[scores$Code.commune >6160 & scores$Code.commune < 6210] <- "ALL"
scores$langue[scores$Code.commune >6210 & scores$Code.commune < 6270] <- "FRA"
scores$langue[scores$Code.commune >6270 & scores$Code.commune < 6301] <- "ALL"
scores$Colour[scores$langue == "FRA"]="#FF3D00"
scores$Colour[scores$langue == "ALL"]="#5DE100"
scores$Colour[scores$langue == "ITA"]="#FFBC00"
par(pty="s")
plot(-scores$RC3, scores$RC1, xlab = "", ylab = "", xaxt='n', yaxt="n", cex=sqrt(scores$Habitants/10000),pch=16, col=scores$Colour)
mtext('Droite', side=4, line=2, las=1)
mtext('Gauche', side=2, line=2, las=1)
mtext("LibÃ©ral", side =3, line=1)
mtext("Conservateur", side =1, line=1)
legend("bottomleft",col = c("#FF3D00","#5DE100","#FFBC00"), legend = c("FRA","ALL","ITA"),pch=16)
scores$RC3 <- -scores$RC3
install.packages("ggtern")
library(ggtern)
h <- ((4* sd(scores$RC3)^5)/(3*(nrow(scores))))^(1/5)
h <- ((4* sd(scores$RC1)^5)/(3*(nrow(scores))))^(1/5)
h <- ((4* sd(scores$RC3)^5)/(3*(nrow(scores))))^(1/5)
kde <- kde2d.weighted(x = scores$RC3, y = scores$RC1, w=scores$Habitants, h=h)
View(kde)
install.packages("spatialEco")
coordinates(scores) ~ RC3 + RC1
coordinates(scores) <- ~ RC3 + RC1
require(spatialEco)
coordinates(scores) <- ~ RC3 + RC1
require(sp)
coordinates(scores) <- ~ RC3 + RC1
range(scores$RC2)
range(scores$RC1)
range(scores$RC3)
10/h
kde <- sp.kde(scores, y= scores$Habitants, bw = h, newdata = c(-5,5,-5,5), n= 25000)
